---
import '../styles/global.css';

interface Props {
	title: string;
}

const { title } = Astro.props;

// 1. è·å–å½“å‰è·¯å¾„
const pathname = Astro.url.pathname;

// 2. å®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦é«˜äº®
// é€»è¾‘ï¼šå¦‚æœå½“å‰è·¯å¾„ä»¥ç›®æ ‡é“¾æ¥å¼€å¤´ï¼Œå°±è§†ä¸ºæ¿€æ´»ï¼ˆæ¯”å¦‚ /blog/post-1 ä¹Ÿå±äº /blogï¼‰
const isActive = (path: string) => {
    // é¦–é¡µç‰¹æ®Šå¤„ç†ï¼šå¿…é¡»å®Œå…¨åŒ¹é… '/'
    if (path === '/') return pathname === '/';
    // å…¶ä»–é¡µé¢ï¼šåªè¦ä»¥è·¯å¾„å¼€å¤´å³å¯ï¼ˆæ¯”å¦‚ /blog å’Œ /blog/hello éƒ½èƒ½åŒ¹é…ï¼‰
    return pathname.startsWith(path);
};
---

<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Astro description" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
        <!-- å¼•å…¥ Google Fonts (å¯é€‰ï¼Œå¢åŠ è®¾è®¡æ„Ÿ) -->
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
        
        <!-- æ ¸å¿ƒï¼šé˜²æ­¢é¡µé¢åŠ è½½æ—¶ä¸»é¢˜é—ªçƒçš„è„šæœ¬ -->
        <script is:inline>
            const theme = (() => {
                if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
                    return localStorage.getItem('theme');
                }
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    return 'dark';
                }
                return 'light';
            })();
            if (theme === 'light') {
                document.documentElement.classList.remove('dark');
            } else {
                document.documentElement.classList.add('dark');
            }
        </script>
	</head>
	<body class="font-sans min-h-screen">
        <!-- é¡¶éƒ¨å¯¼èˆªæ å ä½ -->
        <nav class="fixed top-0 w-full z-50 h-16 glass-panel border-b-0 rounded-none flex items-center justify-between px-8 transition-all duration-300">
    <!-- å·¦ä¾§ LOGO -->
    <a href="/" class="group flex items-center gap-2">
        <div class="font-black text-xl tracking-widest group-hover:text-acg-pink transition-colors">
            TGV<span class="text-acg-blue"> Verse</span>
        </div>
    </a>

    <!-- ä¸­é—´ å¯¼èˆªé“¾æ¥ -->
    <div class="hidden md:flex gap-8 text-sm font-medium">
        <!-- é¦–é¡µ -->
        <a href="/" class={
            isActive('/') 
            ? "text-acg-blue font-bold drop-shadow-[0_0_8px_rgba(0,229,255,0.6)]" 
            : "opacity-70 hover:opacity-100 hover:text-acg-blue transition-all"
        }>
            é¦–é¡µ
        </a>

        <!-- ç¬”è®° (Blog) -->
        <a href="/blog" class={
            isActive('/blog') 
            ? "text-acg-blue font-bold drop-shadow-[0_0_8px_rgba(0,229,255,0.6)]" 
            : "opacity-70 hover:opacity-100 hover:text-acg-blue transition-all"
        }>
            ç¬”è®°
        </a>

        <!-- å¼€å‘æ—¥å¿— (DevLog) - ç‰¹æ®Šç²‰è‰²é«˜äº® -->
        <a href="/devlog" class={
            isActive('/devlog') 
            ? "text-acg-pink font-bold drop-shadow-[0_0_8px_rgba(255,0,85,0.6)]" 
            : "opacity-70 hover:opacity-100 hover:text-acg-pink transition-all"
        }>
            å¼€å‘æ—¥å¿—
        </a>

        <!-- ç”»å»Š -->
        <a href="/gallery" class={
            isActive('/gallery') 
            ? "text-acg-blue font-bold drop-shadow-[0_0_8px_rgba(0,229,255,0.6)]" 
            : "opacity-70 hover:opacity-100 hover:text-acg-blue transition-all"
        }>
            ç”»å»Š
        </a>

        <!-- å·¥å…·ç®± -->
        <a href="/tools" class={
            isActive('/tools') 
            ? "text-acg-blue font-bold drop-shadow-[0_0_8px_rgba(0,229,255,0.6)]" 
            : "opacity-70 hover:opacity-100 hover:text-acg-blue transition-all"
        }>
            å·¥å…·ç®±
        </a>
    </div>

    <!-- å³ä¾§ ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
    <button id="themeToggle" class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition active:scale-90">
        <span class="dark:hidden">â˜€ï¸</span>
        <span class="hidden dark:inline">ğŸŒ™</span>
    </button>
</nav>

        <!-- é¡µé¢å†…å®¹æ’æ§½ -->
		<slot />

        <!-- ç®€å•çš„åº•éƒ¨ -->
        <footer class="mt-20 py-8 text-center text-sm glass-panel rounded-none border-t border-b-0">
            <p>Â© 2026 My Blog Built with Astro.</p>
        </footer>

        <!-- ä¸»é¢˜åˆ‡æ¢é€»è¾‘ -->
        <script>
            const handleToggleClick = () => {
                const element = document.documentElement;
                element.classList.toggle("dark");
                const isDark = element.classList.contains("dark");
                localStorage.setItem("theme", isDark ? "dark" : "light");
            }
            document.getElementById("themeToggle").addEventListener("click", handleToggleClick);
        </script>
	</body>
</html>